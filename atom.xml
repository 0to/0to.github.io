<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Just Do IT</title>
  <subtitle>Yesterday You Said Tomorrow</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://0to.github.io/"/>
  <updated>2017-03-31T05:28:16.000Z</updated>
  <id>https://0to.github.io/</id>
  
  <author>
    <name>Weilong</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>使用Jenkins_Gerrit搭建持续集成</title>
    <link href="https://0to.github.io/2017/03/31/%E4%BD%BF%E7%94%A8Jenkins-Gerrit%E6%90%AD%E5%BB%BA%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90/"/>
    <id>https://0to.github.io/2017/03/31/使用Jenkins-Gerrit搭建持续集成/</id>
    <published>2017-03-31T02:46:37.000Z</published>
    <updated>2017-03-31T05:28:16.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="背景："><a href="#背景：" class="headerlink" title="背景："></a>背景：</h1><blockquote>
<p>公司目前使用Gerrit作为代码库托管和Code review平台。 使用Jenkins作为自动化构建和持续集成平台。</p>
</blockquote>
<h2 id="流程设计："><a href="#流程设计：" class="headerlink" title="流程设计："></a>流程设计：</h2><p><img src="/2017/03/31/使用Jenkins-Gerrit搭建持续集成/CI.png" alt="logo"></p>
<ol>
<li><p>Dev本地开发，然后上传patch到gerrit：</p>
<ul>
<li>同时触发Jenkins CR_Job来做build</li>
<li>增加Code reviewers来做review</li>
</ul>
</li>
<li><p>再上述都成功的基础上，reviewer点击+2：</p>
<ul>
<li><p>同时触发Jenkins Submit_Job来做build和test：</p>
<ul>
<li>如果成功，自动合并本次patch到代码库</li>
<li>如果失败，返回-1</li>
</ul>
</li>
</ul>
</li>
<li><p>Nightly test Job：</p>
<ul>
<li>每晚20:00触发，获取当前最新的代码进行build和test</li>
</ul>
</li>
</ol>
<blockquote>
<p>测试分级：</p>
<ul>
<li><p>CR_Job:</p>
<ul>
<li>获取触发patch的代码，合并最新分支代码，进行build</li>
<li>快速反馈，主要检查patch合并是否有冲突和build是否能跑通</li>
</ul>
</li>
<li><p>Submit_Job：</p>
<ul>
<li>获取触发patch的代码，合并最新的分支代码，进行build和测试</li>
<li>根据每天代码提交次数来确定时间和test cases</li>
</ul>
</li>
<li><p>Nightly_Job：</p>
<ul>
<li>获取当前最新代码进行build和test</li>
<li>一般跑12h，第二天早上出测试报告邮件</li>
</ul>
</li>
</ul>
</blockquote>
<h2 id="软件环境："><a href="#软件环境：" class="headerlink" title="软件环境："></a>软件环境：</h2><table>
<thead>
<tr>
<th>软件</th>
<th>版本</th>
</tr>
</thead>
<tbody>
<tr>
<td>Jenkins</td>
<td>1.567</td>
</tr>
<tr>
<td>Gerrit</td>
<td>2.8.6</td>
</tr>
</tbody>
</table>
<ul>
<li>Jenkins插件：</li>
</ul>
<table>
<thead>
<tr>
<th>插件名</th>
<th>版本</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>Multijob plugin</td>
<td>2.11.1</td>
<td>定义pipeline</td>
</tr>
<tr>
<td>Gerrit Trigger</td>
<td>1.13</td>
<td>监控Gerrit event</td>
</tr>
</tbody>
</table>
<h2 id="搭建步骤："><a href="#搭建步骤：" class="headerlink" title="搭建步骤："></a>搭建步骤：</h2><ol>
<li>安装配置Jenkins Gerrit Trigger插件： <a href="https://wiki.jenkins-ci.org/display/JENKINS/Gerrit+Trigger" target="_blank" rel="external">官方wiki</a> <img src="/2017/03/31/使用Jenkins-Gerrit搭建持续集成/Gerrit_Trigger.png" alt="logo"></li>
<li>安装Jenkins Multijob plugin： <a href="https://wiki.jenkins-ci.org/display/JENKINS/Multijob+Plugin" target="_blank" rel="external">官方wiki</a> <img src="/2017/03/31/使用Jenkins-Gerrit搭建持续集成/multi_jobs.png" alt="logo"></li>
<li>配置CR_Job: <img src="/2017/03/31/使用Jenkins-Gerrit搭建持续集成/CR_Job.png" alt="logo"></li>
<li>配置Submit_job: <img src="/2017/03/31/使用Jenkins-Gerrit搭建持续集成/submit_job.png" alt="logo"></li>
<li>配置Nightly_Job: <img src="/2017/03/31/使用Jenkins-Gerrit搭建持续集成/nightly_job.png" alt="logo"></li>
</ol>
<h2 id="PS"><a href="#PS" class="headerlink" title="PS"></a>PS</h2><ol>
<li>以上内容都是基于公司研发现状定制的，建议各位根据自己的情况进行定制。</li>
<li>因为历史遗留原因，当前使用的版本比较旧。 例如如果升级到jenkins2.x版本的话pipeline就不需要借助插件来实现了。</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;背景：&quot;&gt;&lt;a href=&quot;#背景：&quot; class=&quot;headerlink&quot; title=&quot;背景：&quot;&gt;&lt;/a&gt;背景：&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;公司目前使用Gerrit作为代码库托管和Code review平台。 使用Jenkins作为自动化构建和持
    
    </summary>
    
      <category term="SCM" scheme="https://0to.github.io/categories/SCM/"/>
    
    
      <category term="Jenkins" scheme="https://0to.github.io/tags/Jenkins/"/>
    
      <category term="Gerrit" scheme="https://0to.github.io/tags/Gerrit/"/>
    
  </entry>
  
  <entry>
    <title>Jenkins常用插件</title>
    <link href="https://0to.github.io/2017/01/24/jenkins%E6%8F%92%E4%BB%B6/"/>
    <id>https://0to.github.io/2017/01/24/jenkins插件/</id>
    <published>2017-01-24T10:18:19.000Z</published>
    <updated>2017-01-24T11:06:40.000Z</updated>
    
    <content type="html"><![CDATA[<ul>
<li><p>build-user-vars-plugin<br><a href="https://wiki.jenkins-ci.org/display/JENKINS/Build+User+Vars+Plugin" target="_blank" rel="external">https://wiki.jenkins-ci.org/display/JENKINS/Build+User+Vars+Plugin</a><br>用途：获取构建的执行人信息<br>需要在job配置中勾选Set jenkins user build variables</p>
</li>
<li><p>gerrit-trigger<br><a href="https://wiki.jenkins-ci.org/display/JENKINS/Gerrit+Trigger" target="_blank" rel="external">https://wiki.jenkins-ci.org/display/JENKINS/Gerrit+Trigger</a><br>用途：打通gerit和jenkins<br>主要用于：gerrit事件触发jenkins job，jenkins job执行结果反写回gerrit</p>
</li>
<li><p>thinBackup<br><a href="https://wiki.jenkins-ci.org/display/JENKINS/thinBackup" target="_blank" rel="external">https://wiki.jenkins-ci.org/display/JENKINS/thinBackup</a><br>用途：备份jenkins配置和job配置</p>
</li>
<li><p>saferestart<br><a href="https://wiki.jenkins-ci.org/display/JENKINS/SafeRestart+Plugin" target="_blank" rel="external">https://wiki.jenkins-ci.org/display/JENKINS/SafeRestart+Plugin</a><br>用途：提供一个按钮来安全重启jenkins<br>点击后，如果有job正在执行那么等job执行完毕后会重启jenkins，点击后再加进来的job会等待重启完成后执行。</p>
</li>
<li><p>jobConfigHistory<br><a href="https://wiki.jenkins-ci.org/display/JENKINS/JobConfigHistory+Plugin" target="_blank" rel="external">https://wiki.jenkins-ci.org/display/JENKINS/JobConfigHistory+Plugin</a><br>用途：记录每次job配置变更，支持查找历史版本和回滚</p>
</li>
<li><p>rebuild<br><a href="https://wiki.jenkins-ci.org/display/JENKINS/Rebuild+Plugin" target="_blank" rel="external">https://wiki.jenkins-ci.org/display/JENKINS/Rebuild+Plugin</a><br>用途：增加rebuild按钮用来使用相同的参数再次执行构建<br>gerrit触发的job 要使用  Retrigger 而不是rebuild</p>
</li>
<li><p>jenkins-multijob-plugin<br><a href="https://wiki.jenkins-ci.org/display/JENKINS/Multijob+Plugin" target="_blank" rel="external">https://wiki.jenkins-ci.org/display/JENKINS/Multijob+Plugin</a><br>用途：多个job组成工作流<br>优点：比其它组job流的插件多了最终收集结果功能，而且界面配置简单，功能强大</p>
</li>
<li><p>multiple-scms<br><a href="https://wiki.jenkins-ci.org/display/JENKINS/Multiple+SCMs+Plugin" target="_blank" rel="external">https://wiki.jenkins-ci.org/display/JENKINS/Multiple+SCMs+Plugin</a><br>用途：job支持多个git工程 并且可以配置下载代码到指定目录</p>
</li>
<li><p>Copy Artifact Plugin<br><a href="https://wiki.jenkins-ci.org/display/JENKINS/Copy+Artifact+Plugin" target="_blank" rel="external">https://wiki.jenkins-ci.org/display/JENKINS/Copy+Artifact+Plugin</a><br>用途：拷贝其它job的指定产出物</p>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;ul&gt;
&lt;li&gt;&lt;p&gt;build-user-vars-plugin&lt;br&gt;&lt;a href=&quot;https://wiki.jenkins-ci.org/display/JENKINS/Build+User+Vars+Plugin&quot; target=&quot;_blank&quot; rel=&quot;exte
    
    </summary>
    
      <category term="SCM" scheme="https://0to.github.io/categories/SCM/"/>
    
    
      <category term="Jenkins" scheme="https://0to.github.io/tags/Jenkins/"/>
    
  </entry>
  
</feed>
